!function(){"use strict";class e{constructor(e,t,s,r,i){let{name:n,link:o,isLiked:a,_id:l}=e;this._name=n,this._link=o,this._isLiked=a,this._id=l,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteClick=r,this._handleLikeClick=i}_setEventListeners(){this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})})),this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>{this._handleLikeClick(this)})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._handleDeleteClick(this)}))}handleDeleteCard(){this._cardElement.remove(),this._cardElement=null}isLiked(){return this._isLiked}setIsLiked(e){this._isLiked=e,this._renderLikes()}_renderLikes(){this._isLiked?this._cardElement.querySelector(".card__like-button").classList.add("card__like-button_active"):this._cardElement.querySelector(".card__like-button").classList.remove("card__like-button_active")}createCard(){this._renderLikes()}getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardElement.querySelector(".card__image").setAttribute("src",this._link),this._cardElement.querySelector(".card__image").setAttribute("alt",this._name),this._cardElement.querySelector(".card__title").textContent=this._name,this._renderLikes(),this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._formElement=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_hideInputError(e){this._errorMessageEl=this._formElement.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorMessageEl.textContent="",this._errorMessageEl.classList.remove(this._errorClass)}_showInputError(e){this._errorMessageEl=this._formElement.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorMessageEl.textContent=e.validationMessage,this._errorMessageEl.classList.add(this._errorClass)}_hasInvalidInput(){return this._inputEls.some((e=>!e.validity.valid))}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_setEventListeners(){this._inputEls=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this.disableButton()})),this._setEventListeners(),this._toggleButtonState()}}class s{constructor(e){let{popupSelector:t}=e;this._popup=document.querySelector(t)}_handleEscClose=e=>"Escape"===e.key?this.close():null;open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close"))&&this.close()}))}}class r extends s{constructor(e,t,s){let{popupSelector:r}=e;super({popupSelector:r}),this._popupForm=this._popup.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputValues={},this._formInputs=this._popup.querySelectorAll(".modal__input"),this._submitButton=this._popup.querySelector(".modal__button"),this._buttonText=this._submitButton.textContent,this._loadingButtonText=s}_getInputValues(){return this._formInputs.forEach((e=>{this._inputValues[e.name]=e.value})),this._inputValues}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t)}))}showLoading(){this._submitButton.textContent=this._loadingButtonText}hideLoading(){this._submitButton.textContent=this._buttonText}}const i=document.querySelector("#profile-edit-button"),n=document.querySelector("#profile-edit-modal"),o=document.querySelector("#profile-title-input"),a=document.querySelector("#profile-description-input"),l=n.querySelector(".modal__form"),c=document.querySelector(".profile__add-button"),d=document.querySelector("#card-add-modal").querySelector(".modal__form"),h={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},u=document.querySelector(".profile__image-hover"),_=document.querySelector("#edit-avatar-form");function p(t){const s=new e(t,"#card-template",S,C,k);m.addItem(s.getView())}new t(h,l).enableValidation(),new t(h,d).enableValidation();const m=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:p},".cards__list"),v=new class extends s{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._popupImage=document.querySelector(".modal__preview-image"),this._popupTitle=document.querySelector(".modal__preview-title")}open(e){this._popupImage.src=e.link,this._popupImage.alt=e.name,this._popupTitle.textContent=e.name,super.open()}}({popupSelector:"#preview-image-modal"});function S(e){v.open(e)}v.setEventListeners();const E=new r({popupSelector:"#profile-edit-modal"},(function(e){let{name:t,about:s}=e;E.showLoading(),f.updateInfo(t,s).then((e=>{g.setUserInfo(e),E.close(),l.reset()})).catch((e=>{console.log(e)})).finally((()=>E.hideLoading()))}),"Saving...");E.setEventListeners();const b=new r({popupSelector:"#card-add-modal"},(function(e){b.showLoading(),f.addCard(e.title,e.link).then((e=>{p(e),b.close(),d.reset()})).catch((e=>{console.log(e)})).finally((()=>b.hideLoading()))}),"Creating...");b.setEventListeners();const L=new r({popupSelector:"#edit-avatar-modal"},(function(e){L.showLoading(),f.updateAvatar(e).then((e=>{g.setUserAvatar(e.avatar),L.close(),_.reset()})).catch((e=>{console.log(e)})).finally((()=>{L.hideLoading()}))}),"Saving...");L.setEventListeners(),i.addEventListener("click",(function(){const e=g.getUserInfo();o.value=e.title,a.value=e.description,E.open()})),c.addEventListener("click",(function(){b.open()}));const g=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:r}=e;this._name=document.querySelector(t),this._job=document.querySelector(s),this._avatar=document.querySelector(r)}getUserInfo(){return{title:this._name.textContent,description:this._job.textContent,avatar:this._avatar.src}}setUserInfo(e){let{name:t,about:s}=e;this._name.textContent=t,this._job.textContent=s}setUserAvatar(e){this._avatar.src=e}}({nameSelector:".profile__title",jobSelector:".profile__description",avatarSelector:".profile__image"}),f=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}renderCards(){Promise.all(this.getUserInfo(),this.getInitialCards())}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse)}updateInfo(e,t){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._checkResponse)}updateAvatar(e){let{link:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then(this._checkResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}addCard(e,t){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}dislikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"c6c362c5-eda0-4373-9004-84a264f04392","Content-Type":"application/json"}});function k(e){e.isLiked()?f.dislikeCard(e._id).then((t=>{e.setIsLiked(t.isLiked)})).catch((e=>{console.log(e)})):f.likeCard(e._id).then((t=>{e.setIsLiked(t.isLiked)})).catch((e=>{console.log(e)}))}f.getInitialCards().then((e=>{m.renderItems(e)})).catch((e=>{console.log(e)})),f.getUserInfo().then((e=>{g.setUserInfo(e),g.setUserAvatar(e.avatar)})).catch((e=>{console.log(e)}));const y=new class extends s{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._popupForm=this._popup.querySelector(".modal__form"),this._submitButton=this._popup.querySelector(".modal__button")}handleDelete(e){this._handleDeleteSubmit=e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleDeleteSubmit()}))}renderLoading=e=>{this._submitButton.textContent=e?"Deleting...":"Yes"}}({popupSelector:"#card-delete-modal"});function C(e){y.open(),y.handleDelete((()=>{y.renderLoading(!0),f.deleteCard(e._id).then((()=>{y.close(),e.handleDeleteCard()})).catch((e=>{console.log(e)})).finally((()=>{y.renderLoading(!1)}))}))}y.setEventListeners(),u.addEventListener("click",(()=>{L.open()})),new t(h,_).enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQWUsTUFBTUEsRUFDbkJDLFdBQUFBLENBQVdDLEVBRVRDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBQ0EsSUFMQSxLQUFFQyxFQUFJLEtBQUVDLEVBQUksUUFBRUMsRUFBTyxJQUFFQyxHQUFLUixFQU01QlMsS0FBS0MsTUFBUUwsRUFDYkksS0FBS0UsTUFBUUwsRUFDYkcsS0FBS0csU0FBV0wsRUFDaEJFLEtBQUtELElBQU1BLEVBRVhDLEtBQUtJLGNBQWdCWixFQUNyQlEsS0FBS0ssa0JBQW9CWixFQUN6Qk8sS0FBS00sbUJBQXFCWixFQUMxQk0sS0FBS08saUJBQW1CWixDQUMxQixDQU1BYSxrQkFBQUEsR0FDRVIsS0FBS1MsYUFDRkMsY0FBYyxnQkFDZEMsaUJBQWlCLFNBQVMsS0FDekJYLEtBQUtLLGtCQUFrQixDQUNyQlQsS0FBTUksS0FBS0MsTUFDWEosS0FBTUcsS0FBS0UsT0FDWCxJQUlORixLQUFLUyxhQUNGQyxjQUFjLHNCQUNkQyxpQkFBaUIsU0FBUyxLQUN6QlgsS0FBS08saUJBQWlCUCxLQUFLLElBSS9CQSxLQUFLUyxhQUNGQyxjQUFjLHdCQUNkQyxpQkFBaUIsU0FBUyxLQUN6QlgsS0FBS00sbUJBQW1CTixLQUFLLEdBRW5DLENBT0FZLGdCQUFBQSxHQUNFWixLQUFLUyxhQUFhSSxTQUNsQmIsS0FBS1MsYUFBZSxJQUN0QixDQUVBWCxPQUFBQSxHQUNFLE9BQU9FLEtBQUtHLFFBQ2QsQ0FFQVcsVUFBQUEsQ0FBV2hCLEdBQ1RFLEtBQUtHLFNBQVdMLEVBQ2hCRSxLQUFLZSxjQUNQLENBRUFBLFlBQUFBLEdBQ01mLEtBQUtHLFNBQ1BILEtBQUtTLGFBQ0ZDLGNBQWMsc0JBQ2RNLFVBQVVDLElBQUksNEJBRWpCakIsS0FBS1MsYUFDRkMsY0FBYyxzQkFDZE0sVUFBVUgsT0FBTywyQkFFeEIsQ0FFQUssVUFBQUEsR0FDRWxCLEtBQUtlLGNBQ1AsQ0FHQUksT0FBQUEsR0F5QkUsT0F4QkFuQixLQUFLUyxhQUFlVyxTQUNqQlYsY0FBY1YsS0FBS0ksZUFDbkJpQixRQUFRWCxjQUFjLFNBQ3RCWSxXQUFVLEdBR2J0QixLQUFLUyxhQUNGQyxjQUFjLGdCQUNkYSxhQUFhLE1BQU92QixLQUFLRSxPQUc1QkYsS0FBS1MsYUFDRkMsY0FBYyxnQkFDZGEsYUFBYSxNQUFPdkIsS0FBS0MsT0FHNUJELEtBQUtTLGFBQWFDLGNBQWMsZ0JBQWdCYyxZQUFjeEIsS0FBS0MsTUFFbkVELEtBQUtlLGVBR0xmLEtBQUtRLHFCQUdFUixLQUFLUyxZQUNkLEVDOUdhLE1BQU1nQixFQUNuQm5DLFdBQUFBLENBQVlvQyxFQUFVQyxHQUNwQjNCLEtBQUs0QixhQUFlRCxFQUVwQjNCLEtBQUs2QixlQUFpQkgsRUFBU0ksY0FDL0I5QixLQUFLK0Isc0JBQXdCTCxFQUFTTSxxQkFDdENoQyxLQUFLaUMscUJBQXVCUCxFQUFTUSxvQkFDckNsQyxLQUFLbUMsaUJBQW1CVCxFQUFTVSxnQkFDakNwQyxLQUFLcUMsWUFBY1gsRUFBU1ksVUFDOUIsQ0FNQUMsbUJBQUFBLENBQW9CQyxHQUNiQSxFQUFRQyxTQUFTQyxNQUdwQjFDLEtBQUsyQyxnQkFBZ0JILEdBRnJCeEMsS0FBSzRDLGdCQUFnQkosRUFBU0EsRUFBUUssa0JBSTFDLENBRUFDLGtCQUFBQSxHQUNPOUMsS0FBSytDLG1CQUdSL0MsS0FBS2dELGdCQUZMaEQsS0FBS2lELGVBSVQsQ0FFQU4sZUFBQUEsQ0FBZ0JILEdBQ2R4QyxLQUFLa0QsZ0JBQWtCbEQsS0FBSzRCLGFBQWFsQixjQUN0QyxJQUFHOEIsRUFBUVcsWUFFZFgsRUFBUXhCLFVBQVVILE9BQU9iLEtBQUttQyxrQkFDOUJuQyxLQUFLa0QsZ0JBQWdCMUIsWUFBYyxHQUNuQ3hCLEtBQUtrRCxnQkFBZ0JsQyxVQUFVSCxPQUFPYixLQUFLcUMsWUFDN0MsQ0FFQU8sZUFBQUEsQ0FBZ0JKLEdBQ2R4QyxLQUFLa0QsZ0JBQWtCbEQsS0FBSzRCLGFBQWFsQixjQUN0QyxJQUFHOEIsRUFBUVcsWUFFZFgsRUFBUXhCLFVBQVVDLElBQUlqQixLQUFLbUMsa0JBQzNCbkMsS0FBS2tELGdCQUFnQjFCLFlBQWNnQixFQUFRSyxrQkFDM0M3QyxLQUFLa0QsZ0JBQWdCbEMsVUFBVUMsSUFBSWpCLEtBQUtxQyxZQUMxQyxDQUVBVSxnQkFBQUEsR0FDRSxPQUFPL0MsS0FBS29ELFVBQVVDLE1BQU1iLElBQWFBLEVBQVFDLFNBQVNDLE9BQzVELENBRUFPLGFBQUFBLEdBQ0VqRCxLQUFLc0QsY0FBY3RDLFVBQVVILE9BQU9iLEtBQUtpQyxzQkFDekNqQyxLQUFLc0QsY0FBY0MsVUFBVyxDQUNoQyxDQUVBL0Msa0JBQUFBLEdBQ0VSLEtBQUtvRCxVQUFZLElBQ1pwRCxLQUFLNEIsYUFBYTRCLGlCQUFpQnhELEtBQUs2QixpQkFFN0M3QixLQUFLc0QsY0FBZ0J0RCxLQUFLNEIsYUFBYWxCLGNBQ3JDVixLQUFLK0IsdUJBRVAvQixLQUFLb0QsVUFBVUssU0FBU2pCLElBQ3RCQSxFQUFRN0IsaUJBQWlCLFNBQVUrQyxJQUNqQzFELEtBQUt1QyxvQkFBb0JDLEdBQ3pCeEMsS0FBSzhDLG9CQUFvQixHQUN6QixHQUVOLENBTUFFLGFBQUFBLEdBQ0VoRCxLQUFLc0QsY0FBY3RDLFVBQVVDLElBQUlqQixLQUFLaUMsc0JBQ3RDakMsS0FBS3NELGNBQWNDLFVBQVcsQ0FDaEMsQ0FFQUksZ0JBQUFBLEdBQ0UzRCxLQUFLNEIsYUFBYWpCLGlCQUFpQixVQUFXK0MsSUFDNUNBLEVBQUVFLGlCQUNGNUQsS0FBS2dELGVBQWUsSUFFdEJoRCxLQUFLUSxxQkFDTFIsS0FBSzhDLG9CQUNQLEVDekZhLE1BQU1lLEVBQ25CdkUsV0FBQUEsQ0FBV0MsR0FBb0IsSUFBbkIsY0FBRXVFLEdBQWV2RSxFQUMzQlMsS0FBSytELE9BQVMzQyxTQUFTVixjQUFjb0QsRUFFdkMsQ0FHQUUsZ0JBQW1CTixHQUFpQixXQUFWQSxFQUFFTyxJQUFtQmpFLEtBQUtrRSxRQUFVLEtBRzlEQyxJQUFBQSxHQUNFbkUsS0FBSytELE9BQU8vQyxVQUFVQyxJQUFJLGdCQUMxQkcsU0FBU1QsaUJBQWlCLFVBQVdYLEtBQUtnRSxnQkFDNUMsQ0FHQUUsS0FBQUEsR0FDRWxFLEtBQUsrRCxPQUFPL0MsVUFBVUgsT0FBTyxnQkFDN0JPLFNBQVNnRCxvQkFBb0IsVUFBV3BFLEtBQUtnRSxnQkFDL0MsQ0FHQUssaUJBQUFBLEdBQ0VyRSxLQUFLK0QsT0FBT3BELGlCQUFpQixhQUFjK0MsS0FFdkNBLEVBQUVZLE9BQU90RCxVQUFVdUQsU0FBUyxVQUM1QmIsRUFBRVksT0FBT3RELFVBQVV1RCxTQUFTLGtCQUU1QnZFLEtBQUtrRSxPQUNQLEdBRUosRUM1QmEsTUFBTU0sVUFBc0JYLEVBQ3pDdkUsV0FBQUEsQ0FBV0MsRUFBb0JrRixFQUFrQkMsR0FBbUIsSUFBeEQsY0FBRVosR0FBZXZFLEVBQzNCb0YsTUFBTSxDQUFFYixrQkFDUjlELEtBQUs0RSxXQUFhNUUsS0FBSytELE9BQU9yRCxjQUFjLGdCQUM1Q1YsS0FBSzZFLGtCQUFvQkosRUFDekJ6RSxLQUFLOEUsYUFBZSxDQUFDLEVBQ3JCOUUsS0FBSytFLFlBQWMvRSxLQUFLK0QsT0FBT1AsaUJBQWlCLGlCQUNoRHhELEtBQUtzRCxjQUFnQnRELEtBQUsrRCxPQUFPckQsY0FBYyxrQkFDL0NWLEtBQUtnRixZQUFjaEYsS0FBS3NELGNBQWM5QixZQUN0Q3hCLEtBQUtpRixtQkFBcUJQLENBQzVCLENBRUFRLGVBQUFBLEdBS0UsT0FKQWxGLEtBQUsrRSxZQUFZdEIsU0FBUzBCLElBQ3hCbkYsS0FBSzhFLGFBQWFLLEVBQU12RixNQUFRdUYsRUFBTUMsS0FBSyxJQUd0Q3BGLEtBQUs4RSxZQUNkLENBRUFULGlCQUFBQSxHQUNFTSxNQUFNTixvQkFDTnJFLEtBQUs0RSxXQUFXakUsaUJBQWlCLFVBQVcrQyxJQUMxQ0EsRUFBRUUsaUJBQ0YsTUFBTXlCLEVBQWNyRixLQUFLa0Ysa0JBRXpCbEYsS0FBSzZFLGtCQUFrQlEsRUFBWSxHQUV2QyxDQUVBQyxXQUFBQSxHQUNFdEYsS0FBS3NELGNBQWM5QixZQUFjeEIsS0FBS2lGLGtCQUN4QyxDQUVBTSxXQUFBQSxHQUNFdkYsS0FBS3NELGNBQWM5QixZQUFjeEIsS0FBS2dGLFdBQ3hDLEVDSEssTUFBTVEsRUFBb0JwRSxTQUFTVixjQUFjLHdCQUMzQytFLEVBQW1CckUsU0FBU1YsY0FBYyx1QkFDMUNnRixFQUFvQnRFLFNBQVNWLGNBQWMsd0JBQzNDaUYsRUFBMEJ2RSxTQUFTVixjQUM5Qyw4QkFFV2tGLEVBQWtCSCxFQUFpQi9FLGNBQWMsZ0JBR2pEbUYsRUFBZ0J6RSxTQUFTVixjQUFjLHdCQUV2Q29GLEVBRGUxRSxTQUFTVixjQUFjLG1CQUNYQSxjQUFjLGdCQUd6Q2dCLEVBQVcsQ0FDdEJxRSxhQUFjLGVBQ2RqRSxjQUFlLGdCQUNmRSxxQkFBc0IsaUJBQ3RCRSxvQkFBcUIseUJBQ3JCRSxnQkFBaUIsMEJBQ2pCRSxXQUFZLHdCQUlEMEQsRUFBZTVFLFNBQVNWLGNBQWMseUJBQ3RDdUYsRUFBYTdFLFNBQVNWLGNBQWMscUJDcEJqRCxTQUFTd0YsRUFBV0MsR0FDbEIsTUFBTUMsRUFBTyxJQUFJL0csRUFDZjhHLEVBQ0EsaUJBQ0ExRyxFQUNBQyxFQUNBQyxHQUVGMEcsRUFBWUMsUUFBUUYsRUFBS2pGLFVBQzNCLENBSzZCLElBQUlNLEVBQWNDLEVBQVVrRSxHQUNwQ2pDLG1CQUVJLElBQUlsQyxFQUFjQyxFQUFVb0UsR0FDcENuQyxtQkFJakIsTUFBTTBDLEVBQWMsSUMvREwsTUFDYi9HLFdBQUFBLENBQVdDLEVBQWVDLEdBQWMsSUFBNUIsU0FBRStHLEdBQVVoSCxFQUN0QlMsS0FBS3dHLFVBQVlELEVBQ2pCdkcsS0FBS3lHLFdBQWFyRixTQUFTVixjQUFjbEIsRUFDM0MsQ0FHQWtILFdBQUFBLENBQVlDLEdBQ1ZBLEVBQU1sRCxTQUFTbUQsSUFDYjVHLEtBQUt3RyxVQUFVSSxFQUFLLEdBRXhCLENBR0FOLE9BQUFBLENBQVFNLEdBQ041RyxLQUFLeUcsV0FBV0ksUUFBUUQsRUFDMUIsR0QrQzhCLENBQUVMLFNBQVVMLEdBQWMsZ0JBSXBEWSxFQUFhLElFaEVKLGNBQTZCakQsRUFDMUN2RSxXQUFBQSxDQUFXQyxHQUFvQixJQUFuQixjQUFFdUUsR0FBZXZFLEVBQzNCb0YsTUFBTSxDQUFFYixrQkFFUjlELEtBQUsrRyxZQUFjM0YsU0FBU1YsY0FBYyx5QkFFMUNWLEtBQUtnSCxZQUFjNUYsU0FBU1YsY0FBYyx3QkFDNUMsQ0FFQXlELElBQUFBLENBQUs4QyxHQUVIakgsS0FBSytHLFlBQVlHLElBQU1ELEVBQUtwSCxLQUU1QkcsS0FBSytHLFlBQVlJLElBQU1GLEVBQUtySCxLQUU1QkksS0FBS2dILFlBQVl4RixZQUFjeUYsRUFBS3JILEtBQ3BDK0UsTUFBTVIsTUFDUixHRitDb0MsQ0FDcENMLGNBQWUseUJBSWpCLFNBQVNyRSxFQUFpQndILEdBQ3hCSCxFQUFXM0MsS0FBSzhDLEVBQ2xCLENBSkFILEVBQVd6QyxvQkFRWCxNQUFNK0MsRUFBbUIsSUFBSTVDLEVBQzNCLENBQUVWLGNBQWUsd0JBOERuQixTQUE0QnZFLEdBQWtCLElBQWpCLEtBQUVLLEVBQUksTUFBRXlILEdBQU85SCxFQUMxQzZILEVBQWlCOUIsY0FDakJnQyxFQUNHQyxXQUFXM0gsRUFBTXlILEdBQ2pCRyxNQUFNUCxJQUNMUSxFQUFLQyxZQUFZVCxHQUNqQkcsRUFBaUJsRCxRQUNqQjBCLEVBQWdCK0IsT0FBTyxJQUV4QkMsT0FBT0MsSUFDTkMsUUFBUUMsSUFBSUYsRUFBSSxJQUVqQkcsU0FBUSxJQUFNWixFQUFpQjdCLGVBQ3BDLEdBekVFLGFBR0Y2QixFQUFpQi9DLG9CQUVqQixNQUFNNEQsRUFBZSxJQUFJekQsRUFDdkIsQ0FBRVYsY0FBZSxvQkFnQ25CLFNBQWlDbUQsR0FDL0JnQixFQUFhM0MsY0FDYmdDLEVBQ0dZLFFBQVFqQixFQUFLa0IsTUFBT2xCLEVBQUtwSCxNQUN6QjJILE1BQU1ZLElBQ0xsQyxFQUFXa0MsR0FDWEgsRUFBYS9ELFFBQ2I0QixFQUFZNkIsT0FBTyxJQUVwQkMsT0FBT0MsSUFDTkMsUUFBUUMsSUFBSUYsRUFBSSxJQUVqQkcsU0FBUSxJQUFNQyxFQUFhMUMsZUFDaEMsR0EzQ0UsZUFHRjBDLEVBQWE1RCxvQkFFYixNQUFNZ0UsRUFBYyxJQUFJN0QsRUFDdEIsQ0FDRVYsY0FBZSx1QkE2SW5CLFNBQTRCbUQsR0FDMUJvQixFQUFZL0MsY0FDWmdDLEVBQ0dnQixhQUFhckIsR0FDYk8sTUFBTVksSUFDTFgsRUFBS2MsY0FBY0gsRUFBSUksUUFDdkJILEVBQVluRSxRQUNaK0IsRUFBVzBCLE9BQU8sSUFFbkJDLE9BQU9DLElBQ05DLFFBQVFDLElBQUlGLEVBQUksSUFFakJHLFNBQVEsS0FDUEssRUFBWTlDLGFBQWEsR0FFL0IsR0F6SkUsYUFHRjhDLEVBQVloRSxvQkFNWm1CLEVBQWtCN0UsaUJBQWlCLFNBMEJuQyxXQUNFLE1BQU04SCxFQUFrQmhCLEVBQUtpQixjQUM3QmhELEVBQWtCTixNQUFRcUQsRUFBZ0JOLE1BQzFDeEMsRUFBd0JQLE1BQVFxRCxFQUFnQkUsWUFDaER2QixFQUFpQmpELE1BQ25CLElBOUJBMEIsRUFBY2xGLGlCQUFpQixTQUwvQixXQUNFc0gsRUFBYTlELE1BQ2YsSUFPQSxNQUFNc0QsRUFBTyxJR2pIRSxNQUNibkksV0FBQUEsQ0FBV0MsR0FBZ0QsSUFBL0MsYUFBRXFKLEVBQVksWUFBRUMsRUFBVyxlQUFFQyxHQUFnQnZKLEVBQ3ZEUyxLQUFLQyxNQUFRbUIsU0FBU1YsY0FBY2tJLEdBQ3BDNUksS0FBSytJLEtBQU8zSCxTQUFTVixjQUFjbUksR0FDbkM3SSxLQUFLZ0osUUFBVTVILFNBQVNWLGNBQWNvSSxFQUN4QyxDQUdBSixXQUFBQSxHQUNFLE1BQU8sQ0FDTFAsTUFBT25JLEtBQUtDLE1BQU11QixZQUNsQm1ILFlBQWEzSSxLQUFLK0ksS0FBS3ZILFlBQ3ZCZ0gsT0FBUXhJLEtBQUtnSixRQUFROUIsSUFFekIsQ0FHQVEsV0FBQUEsQ0FBV3VCLEdBQWtCLElBQWpCLEtBQUVySixFQUFJLE1BQUV5SCxHQUFPNEIsRUFDekJqSixLQUFLQyxNQUFNdUIsWUFBYzVCLEVBQ3pCSSxLQUFLK0ksS0FBS3ZILFlBQWM2RixDQUMxQixDQUVBa0IsYUFBQUEsQ0FBYzFJLEdBQ1pHLEtBQUtnSixRQUFROUIsSUFBTXJILENBQ3JCLEdIeUZ3QixDQUN4QitJLGFBQWMsa0JBQ2RDLFlBQWEsd0JBQ2JDLGVBQWdCLG9CQXlDWnhCLEVBQU0sSUk3SkcsTUFDYmhJLFdBQUFBLENBQVdDLEdBQXVCLElBQXRCLFFBQUUySixFQUFPLFFBQUVDLEdBQVM1SixFQUM5QlMsS0FBS29KLFNBQVdGLEVBQ2hCbEosS0FBS3FKLFNBQVdGLENBQ2xCLENBRUFHLGNBQUFBLENBQWVsQixHQUNiLE9BQUlBLEVBQUltQixHQUNDbkIsRUFBSW9CLE9BR05DLFFBQVFDLE9BQVEsVUFBU3RCLEVBQUl1QixTQUN0QyxDQUVBQyxXQUFBQSxHQUNFSCxRQUFRSSxJQUFJN0osS0FBSzBJLGNBQWUxSSxLQUFLOEosa0JBQ3ZDLENBR0FwQixXQUFBQSxHQUNFLE9BQU9xQixNQUFPLEdBQUUvSixLQUFLb0osb0JBQXFCLENBQ3hDRCxRQUFTbkosS0FBS3FKLFdBQ2I3QixLQUFLeEgsS0FBS3NKLGVBQ2YsQ0FFQS9CLFVBQUFBLENBQVczSCxFQUFNeUgsR0FDZixPQUFPMEMsTUFBTyxHQUFFL0osS0FBS29KLG9CQUFxQixDQUN4Q1ksT0FBUSxRQUNSYixRQUFTbkosS0FBS3FKLFNBQ2RZLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkJ2SyxPQUNBeUgsWUFFREcsS0FBS3hILEtBQUtzSixlQUNmLENBRUFoQixZQUFBQSxDQUFZVyxHQUFXLElBQVYsS0FBRXBKLEdBQU1vSixFQUNuQixPQUFPYyxNQUFPLEdBQUUvSixLQUFLb0osMkJBQTRCLENBQy9DWSxPQUFRLFFBQ1JiLFFBQVNuSixLQUFLcUosU0FDZFksS0FBTUMsS0FBS0MsVUFBVSxDQUNuQjNCLE9BQVEzSSxNQUVUMkgsS0FBS3hILEtBQUtzSixlQUNmLENBR0FRLGVBQUFBLEdBQ0UsT0FBT0MsTUFBTyxHQUFFL0osS0FBS29KLGlCQUFrQixDQUNyQ0QsUUFBU25KLEtBQUtxSixXQUNiN0IsS0FBS3hILEtBQUtzSixlQUNmLENBRUFwQixPQUFBQSxDQUFRdEksRUFBTUMsR0FDWixPQUFPa0ssTUFBTyxHQUFFL0osS0FBS29KLGlCQUFrQixDQUNyQ1ksT0FBUSxPQUNSYixRQUFTbkosS0FBS3FKLFNBQ2RZLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkJ2SyxPQUNBQyxXQUVEMkgsS0FBS3hILEtBQUtzSixlQUNmLENBRUFjLFVBQUFBLENBQVdDLEdBQ1QsT0FBT04sTUFBTyxHQUFFL0osS0FBS29KLGtCQUFrQmlCLElBQVUsQ0FDL0NMLE9BQVEsU0FDUmIsUUFBU25KLEtBQUtxSixXQUNiN0IsS0FBS3hILEtBQUtzSixlQUNmLENBRUFnQixRQUFBQSxDQUFTRCxHQUNQLE9BQU9OLE1BQU8sR0FBRS9KLEtBQUtvSixrQkFBa0JpQixVQUFnQixDQUNyREwsT0FBUSxNQUNSYixRQUFTbkosS0FBS3FKLFdBQ2I3QixLQUFLeEgsS0FBS3NKLGVBQ2YsQ0FFQWlCLFdBQUFBLENBQVlGLEdBQ1YsT0FBT04sTUFBTyxHQUFFL0osS0FBS29KLGtCQUFrQmlCLFVBQWdCLENBQ3JETCxPQUFRLFNBQ1JiLFFBQVNuSixLQUFLcUosV0FDYjdCLEtBQUt4SCxLQUFLc0osZUFDZixHSjBFa0IsQ0FDbEJKLFFBQVMsa0RBQ1RDLFFBQVMsQ0FDUHFCLGNBQWUsdUNBQ2YsZUFBZ0Isc0JBeUJwQixTQUFTN0ssRUFBZ0J5RyxHQUNuQkEsRUFBS3RHLFVBQ1B3SCxFQUNHaUQsWUFBWW5FLEVBQUtyRyxLQUNqQnlILE1BQU1ZLElBQ0xoQyxFQUFLdEYsV0FBV3NILEVBQUl0SSxRQUFRLElBRTdCOEgsT0FBT0MsSUFDTkMsUUFBUUMsSUFBSUYsRUFBSSxJQUdwQlAsRUFDR2dELFNBQVNsRSxFQUFLckcsS0FDZHlILE1BQU1ZLElBQ0xoQyxFQUFLdEYsV0FBV3NILEVBQUl0SSxRQUFRLElBRTdCOEgsT0FBT0MsSUFDTkMsUUFBUUMsSUFBSUYsRUFBSSxHQUd4QixDQXhDQVAsRUFDR3dDLGtCQUNBdEMsTUFBTXJCLElBQ0xFLEVBQVlLLFlBQVlQLEVBQVMsSUFFbEN5QixPQUFPQyxJQUNOQyxRQUFRQyxJQUFJRixFQUFJLElBSXBCUCxFQUNHb0IsY0FDQWxCLE1BQU1pRCxJQUNMaEQsRUFBS0MsWUFBWStDLEdBQ2pCaEQsRUFBS2MsY0FBY2tDLEVBQVNqQyxPQUFPLElBRXBDWixPQUFPQyxJQUNOQyxRQUFRQyxJQUFJRixFQUFJLElBMEJwQixNQUFNNkMsRUFBcUIsSUsvTVosY0FBb0M3RyxFQUNqRHZFLFdBQUFBLENBQVdDLEdBQW9CLElBQW5CLGNBQUV1RSxHQUFldkUsRUFDM0JvRixNQUFNLENBQUViLGtCQUNSOUQsS0FBSzRFLFdBQWE1RSxLQUFLK0QsT0FBT3JELGNBQWMsZ0JBQzVDVixLQUFLc0QsY0FBZ0J0RCxLQUFLK0QsT0FBT3JELGNBQWMsaUJBQ2pELENBRUFpSyxZQUFBQSxDQUFhQyxHQUNYNUssS0FBSzZLLG9CQUFzQkQsQ0FDN0IsQ0FFQXZHLGlCQUFBQSxHQUNFTSxNQUFNTixvQkFDTnJFLEtBQUs0RSxXQUFXakUsaUJBQWlCLFVBQVcrQyxJQUMxQ0EsRUFBRUUsaUJBQ0Y1RCxLQUFLNksscUJBQXFCLEdBRTlCLENBRUFDLGNBQWlCQyxJQUNmL0ssS0FBS3NELGNBQWM5QixZQUFjdUosRUFBVyxjQUFnQixLQUFLLEdMMkxoQixDQUNuRGpILGNBQWUsdUJBSWpCLFNBQVNwRSxFQUFrQjBHLEdBQ3pCc0UsRUFBbUJ2RyxPQUNuQnVHLEVBQW1CQyxjQUFhLEtBQzlCRCxFQUFtQkksZUFBYyxHQUNqQ3hELEVBQ0c4QyxXQUFXaEUsRUFBS3JHLEtBQ2hCeUgsTUFBSyxLQUVKa0QsRUFBbUJ4RyxRQUNuQmtDLEVBQUt4RixrQkFBa0IsSUFFeEJnSCxPQUFPQyxJQUNOQyxRQUFRQyxJQUFJRixFQUFJLElBRWpCRyxTQUFRLEtBQ1AwQyxFQUFtQkksZUFBYyxFQUFNLEdBQ3ZDLEdBRVIsQ0FHQUosRUFBbUJyRyxvQkFtQm5CMkIsRUFBYXJGLGlCQUFpQixTQUFTLEtBQ3JDMEgsRUFBWWxFLE1BQU0sSUFHSSxJQUFJMUMsRUFBY0MsRUFBVXVFLEdBQ3BDdEMsa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHsgbmFtZSwgbGluaywgaXNMaWtlZCwgX2lkIH0sXG4gICAgY2FyZFNlbGVjdG9yLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXG4gICAgaGFuZGxlTGlrZUNsaWNrXG4gICkge1xuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBsaW5rO1xuICAgIHRoaXMuX2lzTGlrZWQgPSBpc0xpa2VkO1xuICAgIHRoaXMuX2lkID0gX2lkO1xuXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICB9XG5cbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbiAgLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQgbGlzdGVuZXJzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7XG4gICAgICAgICAgbmFtZTogdGhpcy5fbmFtZSxcbiAgICAgICAgICBsaW5rOiB0aGlzLl9saW5rLFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgLy8uY2FyZF9fbGlrZS1idXR0b25cbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcyk7XG4gICAgICB9KTtcblxuICAgIC8vLmNhcmRfX2RlbGV0ZS1idXR0b25cbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMpO1xuICAgICAgfSk7XG4gIH1cblxuICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuICAvKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVycyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4gIC8vZGVsZXRlIGZ1bmN0aW9uXG4gIGhhbmRsZURlbGV0ZUNhcmQoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xuICB9XG5cbiAgaXNMaWtlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5faXNMaWtlZDtcbiAgfVxuXG4gIHNldElzTGlrZWQoaXNMaWtlZCkge1xuICAgIHRoaXMuX2lzTGlrZWQgPSBpc0xpa2VkO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gIH1cblxuICBfcmVuZGVyTGlrZXMoKSB7XG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcbiAgICAgIHRoaXMuX2NhcmRFbGVtZW50XG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXG4gICAgICAgIC5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxuICAgICAgICAuY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9XG4gIH1cblxuICBjcmVhdGVDYXJkKCkge1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gIH1cblxuICAvL2Z1bmN0aW9uIHRvIHJlbmRlciB0aGUgY2FyZHNcbiAgZ2V0VmlldygpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICAvL3NldCBzcmNcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIilcbiAgICAgIC5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgdGhpcy5fbGluayk7XG5cbiAgICAvL3NldCBhbHRcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIilcbiAgICAgIC5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgdGhpcy5fbmFtZSk7XG5cbiAgICAvL3NldCBkZXNjcmlwdGlvblxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcblxuICAgIC8vc2V0IGV2ZW50IGxpc3RlbmVyc1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICAvL3JldHVybiB0aGUgY2FyZFxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWwpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbDtcblxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xuICB9XG5cbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbiAgLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHJpdmF0ZSBNZXRob2RzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwsIGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKCF0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xuICAgIH1cbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWwuaWR9LWVycm9yYFxuICAgICk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsLmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRFbHMuc29tZSgoaW5wdXRFbCkgPT4gIWlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xuICB9XG5cbiAgX2VuYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dEVscyA9IFtcbiAgICAgIC4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvciksXG4gICAgXTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbiAgLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHVibGljIE1ldGhvZHMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuICBkaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICAvLyB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gIH1cblxuICAvL2xpc3RlbnMgZm9yIGVzYyBidXR0b25cbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGUpID0+IChlLmtleSA9PT0gXCJFc2NhcGVcIiA/IHRoaXMuY2xvc2UoKSA6IG51bGwpO1xuXG4gIC8vb3BlbiBtb2RhbFxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgLy9jbG9zZSBtb2RhbFxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIC8vc2V0cyBldmVudCBsaXN0ZW5lcnNcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZSkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSB8fFxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIilcbiAgICAgICkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsIi8vaW1wb3J0IFBvcHVwIGNsYXNzXG5pbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0sIGhhbmRsZUZvcm1TdWJtaXQsIGxvYWRpbmdCdXR0b25UZXh0KSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5faW5wdXRWYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9mb3JtSW5wdXRzID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuICAgIHRoaXMuX2J1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XG4gICAgdGhpcy5fbG9hZGluZ0J1dHRvblRleHQgPSBsb2FkaW5nQnV0dG9uVGV4dDtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICB0aGlzLl9mb3JtSW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICB0aGlzLl9pbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0VmFsdWVzO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xuICAgICAgLy9pbnNlcnRzIHRoZSBpbnB1dHMgaW4gdGhlIGZvcm1cbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpO1xuICAgIH0pO1xuICB9XG5cbiAgc2hvd0xvYWRpbmcoKSB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fbG9hZGluZ0J1dHRvblRleHQ7XG4gIH1cblxuICBoaWRlTG9hZGluZygpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9idXR0b25UZXh0O1xuICB9XG59XG4iLCIvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBcnJheSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vaW5pdGlhbENhcmRzID0gW1xuLy8gICB7XG4vLyAgICAgbmFtZTogXCJIYW5naW5nIExha2VcIixcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vbWVkaWEuY250cmF2ZWxlci5jb20vcGhvdG9zLzViYjRmNDY3ZGIyMjVhNGY1MDY4NGM5Zi9tYXN0ZXIvd18xOTIwJTJDY19saW1pdC9IYW5naW5nLUxha2UtR2V0dHlJbWFnZXMtNjg4MTI3NDYyLmpwZ1wiLFxuLy8gICB9LFxuLy8gICB7XG4vLyAgICAgbmFtZTogXCJPbmVvbnRhIEdvcmdlXCIsXG4vLyAgICAgbGluazogXCJodHRwczovL2JlYXV0aWZ1bG9yZWdvbi5jb20vd3AtY29udGVudC91cGxvYWRzLzIwMjEvMDMvT25lb250YS1Hb3JnZS1Db2x1bWJpYS1SaXZlci1Hb3JnZS1PcmVnb24tMTAyLTAxNDItNTMzLmpwZ1wiLFxuLy8gICB9LFxuLy8gICB7XG4vLyAgICAgbmFtZTogXCJBbnRlbG9wZSBDYW55b25cIixcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vZGV0b3Vyc2FtZXJpY2Fud2VzdC5jb20vd3AtY29udGVudC91cGxvYWRzLzIwMjMvMDMvQW50ZWxvcGUtQ2FueW9uLVRvdXJzLWZyb20tUGhvZW5peC1ERVRPVVJTLUxQLmpwZ1wiLFxuLy8gICB9LFxuLy8gICB7XG4vLyAgICAgbmFtZTogXCJLaWxhdWVhXCIsXG4vLyAgICAgbGluazogXCJodHRwczovL2Nsb3VkZnJvbnQtdXMtZWFzdC0yLmltYWdlcy5hcmNwdWJsaXNoaW5nLmNvbS9yZXV0ZXJzL0M1UEdQWE5STkZOUDVQNFlCUTNFSUpOWDVJLmpwZ1wiLFxuLy8gICB9LFxuLy8gICB7XG4vLyAgICAgbmFtZTogXCJNZW5kZW5oYWxsIEljZSBDYXZlc1wiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9tZWRpYS5jbnRyYXZlbGVyLmNvbS9waG90b3MvNjU0ODZhNDZkNzA2MzYxNmRhYmU0ZTdjL21hc3Rlci93XzE5MjAlMkNjX2xpbWl0L01lbmRlbmhhbGwlMjUyMEdsYWNpZXIlMjUyMGt5c29uLWRhbmEtaTBYTndrRW5BV28tdW5zcGxhc2guanBnXCIsXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIk5pYWdhcmEgRmFsbHNcIixcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vd3d3LmZvZG9ycy5jb20vd3AtY29udGVudC91cGxvYWRzLzIwMjAvMDMvdmVudGktdmlld3MtbU5zXzZWbWJhaUEtdW5zcGxhc2guanBnXCIsXG4vLyAgIH0sXG4vLyBdO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRWxlbWVudHMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vUHJvZmlsZSBNb2RhbFxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEZvcm0gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5cbi8vQWRkIENhcmQgTW9kYWxcbmV4cG9ydCBjb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1hZGQtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZEZvcm0gPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcblxuLy9Gb3IgVmFsaWRhdGlvbiBDbGFzc1xuZXhwb3J0IGNvbnN0IHNldHRpbmdzID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbn07XG5cbi8vQXZhdGFyIE1vZGFsXG5leHBvcnQgY29uc3QgYXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZS1ob3ZlclwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LWF2YXRhci1mb3JtXCIpO1xuIiwiLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbXBvcnRzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vL2ltcG9ydCBuZWVkZWQgZm9yIGNzcyBpbiB3ZWJwYWNrXG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcblxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5cbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcblxuaW1wb3J0IFBvcFVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5cbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcblxuaW1wb3J0IFVzZXJpbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5cbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5cbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XG5cbmltcG9ydCB7XG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxuICBwcm9maWxlVGl0bGVJbnB1dCxcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQsXG4gIHByb2ZpbGVFZGl0Rm9ybSxcbiAgYWRkQ2FyZEJ1dHRvbixcbiAgYWRkQ2FyZEZvcm0sXG4gIHNldHRpbmdzLFxuICBhdmF0YXJCdXR0b24sXG4gIGF2YXRhckZvcm0sXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENsYXNzZXMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIENhcmQgQ2xhc3MgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkRGF0YSxcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVEZWxldGVDbGljayxcbiAgICBoYW5kbGVMaWtlQ2xpY2tcbiAgKTtcbiAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkLmdldFZpZXcoKSk7XG59XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gVmFsaWRhdGlvbiBDbGFzcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vQWRkIFZhbGlkYXRpb24gY2xhc3MgdG8gZm9ybXNcbmNvbnN0IHByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIHByb2ZpbGVFZGl0Rm9ybSk7XG5wcm9maWxlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IGFkZENhcmRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgYWRkQ2FyZEZvcm0pO1xuYWRkQ2FyZFZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBTZWN0aW9uIENsYXNzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbmNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oeyByZW5kZXJlcjogcmVuZGVyQ2FyZCB9LCBcIi5jYXJkc19fbGlzdFwiKTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gUG9wdXBXaXRoSW1hZ2UgQ2xhc3MgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuY29uc3QgaW1hZ2VNb2RhbCA9IG5ldyBQb3BVcFdpdGhJbWFnZSh7XG4gIHBvcHVwU2VsZWN0b3I6IFwiI3ByZXZpZXctaW1hZ2UtbW9kYWxcIixcbn0pO1xuaW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKGRhdGEpIHtcbiAgaW1hZ2VNb2RhbC5vcGVuKGRhdGEpO1xufVxuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gUG9wdXBXaXRoRm9ybSBDbGFzcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5jb25zdCBwcm9maWxlRWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIHsgcG9wdXBTZWxlY3RvcjogXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIgfSxcbiAgaGFuZGxlUHJvZmlsZVN1Ym1pdCxcbiAgXCJTYXZpbmcuLi5cIlxuKTtcblxucHJvZmlsZUVkaXRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgeyBwb3B1cFNlbGVjdG9yOiBcIiNjYXJkLWFkZC1tb2RhbFwiIH0sXG4gIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0LFxuICBcIkNyZWF0aW5nLi4uXCJcbik7XG5cbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBhdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICB7XG4gICAgcG9wdXBTZWxlY3RvcjogXCIjZWRpdC1hdmF0YXItbW9kYWxcIixcbiAgfSxcbiAgaGFuZGxlQXZhdGFyU3VibWl0LFxuICBcIlNhdmluZy4uLlwiXG4pO1xuXG5hdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkRm9ybUJ1dHRvbigpIHtcbiAgYWRkQ2FyZFBvcHVwLm9wZW4oKTtcbn1cblxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUZvcm1CdXR0b24pO1xuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQWRkQ2FyZEZvcm1CdXR0b24pO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBVc2VySW5mbyBDbGFzcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5jb25zdCB1c2VyID0gbmV3IFVzZXJpbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxuICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXG59KTtcblxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQoZGF0YSkge1xuICBhZGRDYXJkUG9wdXAuc2hvd0xvYWRpbmcoKTtcbiAgYXBpXG4gICAgLmFkZENhcmQoZGF0YS50aXRsZSwgZGF0YS5saW5rKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIHJlbmRlckNhcmQocmVzKTtcbiAgICAgIGFkZENhcmRQb3B1cC5jbG9zZSgpO1xuICAgICAgYWRkQ2FyZEZvcm0ucmVzZXQoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4gYWRkQ2FyZFBvcHVwLmhpZGVMb2FkaW5nKCkpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVGb3JtQnV0dG9uKCkge1xuICBjb25zdCB1c2VySW5mb3JtYXRpb24gPSB1c2VyLmdldFVzZXJJbmZvKCk7XG4gIHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gdXNlckluZm9ybWF0aW9uLnRpdGxlO1xuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHVzZXJJbmZvcm1hdGlvbi5kZXNjcmlwdGlvbjtcbiAgcHJvZmlsZUVkaXRQb3B1cC5vcGVuKCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVTdWJtaXQoeyBuYW1lLCBhYm91dCB9KSB7XG4gIHByb2ZpbGVFZGl0UG9wdXAuc2hvd0xvYWRpbmcoKTtcbiAgYXBpXG4gICAgLnVwZGF0ZUluZm8obmFtZSwgYWJvdXQpXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHVzZXIuc2V0VXNlckluZm8oZGF0YSk7XG4gICAgICBwcm9maWxlRWRpdFBvcHVwLmNsb3NlKCk7XG4gICAgICBwcm9maWxlRWRpdEZvcm0ucmVzZXQoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4gcHJvZmlsZUVkaXRQb3B1cC5oaWRlTG9hZGluZygpKTtcbn1cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gQXBpIENsYXNzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcImM2YzM2MmM1LWVkYTAtNDM3My05MDA0LTg0YTI2NGYwNDM5MlwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbi8vVXBsb2FkIGluaXRpYWwgY2FyZHMgdG8gdGhlIERPTVxuYXBpXG4gIC5nZXRJbml0aWFsQ2FyZHMoKVxuICAudGhlbigoY2FyZERhdGEpID0+IHtcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcyhjYXJkRGF0YSk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5sb2coZXJyKTtcbiAgfSk7XG5cbi8vVXBsb2FkcyB1c2VyIGluZm9ybWF0aW9uIGZyb20gc2VydmVyIHRvIERPTVxuYXBpXG4gIC5nZXRVc2VySW5mbygpXG4gIC50aGVuKCh1c2VyRGF0YSkgPT4ge1xuICAgIHVzZXIuc2V0VXNlckluZm8odXNlckRhdGEpO1xuICAgIHVzZXIuc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKGVycik7XG4gIH0pO1xuXG5mdW5jdGlvbiBoYW5kbGVMaWtlQ2xpY2soY2FyZCkge1xuICBpZiAoY2FyZC5pc0xpa2VkKCkpIHtcbiAgICBhcGlcbiAgICAgIC5kaXNsaWtlQ2FyZChjYXJkLl9pZClcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgY2FyZC5zZXRJc0xpa2VkKHJlcy5pc0xpa2VkKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgYXBpXG4gICAgICAubGlrZUNhcmQoY2FyZC5faWQpXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGNhcmQuc2V0SXNMaWtlZChyZXMuaXNMaWtlZCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pO1xuICB9XG59XG5cbi8vc2VsZWN0IHRoZSBkZWxldGUgY29uZmlybWF0aW9uIG1vZGFsXG5jb25zdCBkZWxldGVDb25maXJtTW9kYWwgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKHtcbiAgcG9wdXBTZWxlY3RvcjogXCIjY2FyZC1kZWxldGUtbW9kYWxcIixcbn0pO1xuXG4vL2hhbmRsZXIgZm9yIGRlbGV0ZSBtb2RhbCB0byBhcHBlYXJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNsaWNrKGNhcmQpIHtcbiAgZGVsZXRlQ29uZmlybU1vZGFsLm9wZW4oKTtcbiAgZGVsZXRlQ29uZmlybU1vZGFsLmhhbmRsZURlbGV0ZSgoKSA9PiB7XG4gICAgZGVsZXRlQ29uZmlybU1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgYXBpXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLl9pZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgLy8gY2FyZC5oYW5kbGVEZWxldGUoY2FyZC5faWQpO1xuICAgICAgICBkZWxldGVDb25maXJtTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgY2FyZC5oYW5kbGVEZWxldGVDYXJkKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIGRlbGV0ZUNvbmZpcm1Nb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0pO1xuICB9KTtcbn1cblxuLy9hZGRzIGNsb3NlIHdpdGggZXNjIGFuZCBjbG9zZSBidXR0b25cbmRlbGV0ZUNvbmZpcm1Nb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJTdWJtaXQoZGF0YSkge1xuICBhdmF0YXJQb3B1cC5zaG93TG9hZGluZygpO1xuICBhcGlcbiAgICAudXBkYXRlQXZhdGFyKGRhdGEpXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgdXNlci5zZXRVc2VyQXZhdGFyKHJlcy5hdmF0YXIpO1xuICAgICAgYXZhdGFyUG9wdXAuY2xvc2UoKTtcbiAgICAgIGF2YXRhckZvcm0ucmVzZXQoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgYXZhdGFyUG9wdXAuaGlkZUxvYWRpbmcoKTtcbiAgICB9KTtcbn1cblxuYXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGF2YXRhclBvcHVwLm9wZW4oKTtcbn0pO1xuXG5jb25zdCBhdmF0YXJWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgYXZhdGFyRm9ybSk7XG5hdmF0YXJWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgcmVuZGVyZXIgfSwgY2FyZFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNhcmRTZWxlY3Rvcik7XG4gIH1cblxuICAvL3JlbmRlcnMgYWxsIGVsZW1lbnRzIG9uIHRoZSBwYWdlXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICAvL3Rha2VzIGEgRE9NIGVsZW1lbnQgYW5kIGFkZHMgaXQgdG8gdGhlIGNvbnRhaW5lclxuICBhZGRJdGVtKGl0ZW0pIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcbiAgfVxufVxuIiwiLy9pbXBvcnQgUG9wdXAgY2xhc3NcbmltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3BVcFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgLy9zZWxlY3RzIHRoZSBjdXJyZW50IG1vZGFsIGltYWdlXG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIik7XG4gICAgLy9zZWxlY3RzIHRoZSBjdXJyZW50IG1vZGFsIHRpdGxlXG4gICAgdGhpcy5fcG9wdXBUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctdGl0bGVcIik7XG4gIH1cblxuICBvcGVuKGRhdGEpIHtcbiAgICAvL3NldHMgbW9kYWwgc3JjXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBkYXRhLmxpbms7XG4gICAgLy9zZXRzIG1vZGFsIGFsdFxuICAgIHRoaXMuX3BvcHVwSW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xuICAgIC8vc2V0cyBtb2RhbCB0aXRsZVxuICAgIHRoaXMuX3BvcHVwVGl0bGUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fam9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XG4gICAgdGhpcy5fYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XG4gIH1cblxuICAvL3JldHVybnMgYW4gb2JqZWN0IGNvbnRhaW5pbmcgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHVzZXJcbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRpdGxlOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2pvYi50ZXh0Q29udGVudCxcbiAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyLnNyYyxcbiAgICB9O1xuICB9XG5cbiAgLy90YWtlcyBuZXcgdXNlciBkYXRhIGFuZCBhZGRzIGl0IHRvIHRoZSBwYWdlXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2pvYi50ZXh0Q29udGVudCA9IGFib3V0O1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcihsaW5rKSB7XG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IGxpbms7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG5cbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gIH1cblxuICByZW5kZXJDYXJkcygpIHtcbiAgICBQcm9taXNlLmFsbCh0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCkpO1xuICB9XG5cbiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBVc2VyIFJvdXRlcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgdXBkYXRlSW5mbyhuYW1lLCBhYm91dCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgdXBkYXRlQXZhdGFyKHsgbGluayB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiBsaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gQ2FyZCBSb3V0ZXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBhZGRDYXJkKG5hbWUsIGxpbmspIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgbGluayxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBsaWtlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZGlzbGlrZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gIH1cblxuICBoYW5kbGVEZWxldGUoaGFuZGxlRGVsZXRlU3VibWl0KSB7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlU3VibWl0ID0gaGFuZGxlRGVsZXRlU3VibWl0O1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlU3VibWl0KCk7XG4gICAgfSk7XG4gIH1cblxuICByZW5kZXJMb2FkaW5nID0gKGRlbGV0aW5nKSA9PiB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gZGVsZXRpbmcgPyBcIkRlbGV0aW5nLi4uXCIgOiBcIlllc1wiO1xuICB9O1xufVxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJuYW1lIiwibGluayIsImlzTGlrZWQiLCJfaWQiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9pc0xpa2VkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9jYXJkRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlRGVsZXRlQ2FyZCIsInJlbW92ZSIsInNldElzTGlrZWQiLCJfcmVuZGVyTGlrZXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJjcmVhdGVDYXJkIiwiZ2V0VmlldyIsImRvY3VtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsInNldEF0dHJpYnV0ZSIsInRleHRDb250ZW50IiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImlucHV0RWwiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJfaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsIl9lbmFibGVCdXR0b24iLCJfZXJyb3JNZXNzYWdlRWwiLCJpZCIsIl9pbnB1dEVscyIsInNvbWUiLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImUiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJldmVudERlZmF1bHQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJrZXkiLCJjbG9zZSIsIm9wZW4iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0IiwibG9hZGluZ0J1dHRvblRleHQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9pbnB1dFZhbHVlcyIsIl9mb3JtSW5wdXRzIiwiX2J1dHRvblRleHQiLCJfbG9hZGluZ0J1dHRvblRleHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwiaW5wdXRWYWx1ZXMiLCJzaG93TG9hZGluZyIsImhpZGVMb2FkaW5nIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlRWRpdE1vZGFsIiwicHJvZmlsZVRpdGxlSW5wdXQiLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsInByb2ZpbGVFZGl0Rm9ybSIsImFkZENhcmRCdXR0b24iLCJhZGRDYXJkRm9ybSIsImZvcm1TZWxlY3RvciIsImF2YXRhckJ1dHRvbiIsImF2YXRhckZvcm0iLCJyZW5kZXJDYXJkIiwiY2FyZERhdGEiLCJjYXJkIiwiY2FyZFNlY3Rpb24iLCJhZGRJdGVtIiwicmVuZGVyZXIiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtcyIsIml0ZW0iLCJwcmVwZW5kIiwiaW1hZ2VNb2RhbCIsIl9wb3B1cEltYWdlIiwiX3BvcHVwVGl0bGUiLCJkYXRhIiwic3JjIiwiYWx0IiwicHJvZmlsZUVkaXRQb3B1cCIsImFib3V0IiwiYXBpIiwidXBkYXRlSW5mbyIsInRoZW4iLCJ1c2VyIiwic2V0VXNlckluZm8iLCJyZXNldCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImZpbmFsbHkiLCJhZGRDYXJkUG9wdXAiLCJhZGRDYXJkIiwidGl0bGUiLCJyZXMiLCJhdmF0YXJQb3B1cCIsInVwZGF0ZUF2YXRhciIsInNldFVzZXJBdmF0YXIiLCJhdmF0YXIiLCJ1c2VySW5mb3JtYXRpb24iLCJnZXRVc2VySW5mbyIsImRlc2NyaXB0aW9uIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9qb2IiLCJfYXZhdGFyIiwiX3JlZjIiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJyZW5kZXJDYXJkcyIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwibGlrZUNhcmQiLCJkaXNsaWtlQ2FyZCIsImF1dGhvcml6YXRpb24iLCJ1c2VyRGF0YSIsImRlbGV0ZUNvbmZpcm1Nb2RhbCIsImhhbmRsZURlbGV0ZSIsImhhbmRsZURlbGV0ZVN1Ym1pdCIsIl9oYW5kbGVEZWxldGVTdWJtaXQiLCJyZW5kZXJMb2FkaW5nIiwiZGVsZXRpbmciXSwic291cmNlUm9vdCI6IiJ9